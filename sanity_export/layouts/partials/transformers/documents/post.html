{{ $s := newScratch }}
{{ $s.Set "data" dict }}
{{ $type := "post" }}
{{ if eq $.Type "chairs" }}
  {{ $type = "chair" }}
{{ end }}
{{ $s.SetInMap "data" "_type" $type }}
{{ $s.SetInMap "data" "title" .Title }}
{{ $s.SetInMap "data" "_id" (partial "func/GetID" $) }}
{{ with partial "func/GetAssociation" . }}
  {{ $s.SetInMap "data" "association" . }}
{{ end }}

{{ $s.SetInMap "data" "slug" (partial "transformers/slug" .) }}


{{ with .Params.description }}
  {{ $s.SetInMap "data" "descriptionHTML" ($.Page.RenderString .) }}
{{ else }}
  {{ $s.SetInMap "data" "descriptionHTML" ($.Summary) }}
{{ end }}

{{ with .Date }}
  {{ $s.SetInMap "data" "publishedAt" . }}
{{ end }}

{{ with .Content }}
  {{ $s.SetInMap "data" "bodyHTML" . }}
{{ end }}

{{ with .Params.featured_photo }}
  {{ with partial "transformers/imageObject" . }}
    {{ $image := . }}
    {{ with $.Params.image_credit }}
      {{ $image = merge $image (dict "caption" .) }}
    {{ end }}
    {{ $s.SetInMap "data" "image" $image }}
  {{ end }}
{{ end }}

{{ with .Params.additional_info }}
  {{ $s.SetInMap "data" "additional_info" . }}
{{ end }}

{{ with .Params.galleries }}
  {{ with partial "transformers/gallery" . }}
    {{ $s.SetInMap "data" "gallery" . }}
  {{ end }}
{{ end }}

{{ with .Params.seo }}
  {{ with partial "transformers/seo" . }}
    {{ $s.SetInMap "data" "seo" . }}
  {{ end }}
{{ end }}

{{ with .Params.category }}
  {{ with partial "func/Slugify" . }}
    {{ with partial "func/GetTermID" (dict
    "taxonomy" "taxonomyCategory"
    "term" .
    ) }}
      {{ $s.SetInMap "data" "taxonomyCategories" (slice (dict
        "_type" "reference"
        "_ref" .
      )) }}
    {{ end }}
  {{ end }}
{{ end }}

{{ return $s.Get "data" }}
